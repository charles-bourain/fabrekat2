{% extends "site_base.html" %}
{% load thumbnail %}
{% load filename %}
<!-- Need to load mathfilters(django-mathfilters) to do do division/multiplication/addition/subtraction in templates -->
{% load mathfilters %}

{% block title %}Create - {{block.super}}{% endblock %}

{%block extra_head %} 
	<head>
		{% load staticfiles %}
		<script src='http://code.jquery.com/jquery-latest.js'></script>
	    <script src= "{% static 'project/js/jquery.formset.js' %}" > </script>
	    <script src="{% static 'project/js/jquery.formset.min.js' %}" ></script>
	    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.js" type="text/javascript"></script>
	    <!-- Charlie| Brian this is an important include,Autocomplete_light needs to be loaded AFTER jquery -->
	    {% include 'autocomplete_light/static.html' %}
	       
<!--	    <link rel="stylesheet" type="text/css" href="{% static 'project/style.css' %}"> -->
	</head>
{% endblock %}


{% block body %}
	<body>
		<div>
	        <h1>Edit Project</h1>

	        <form enctype="multipart/form-data" method='POST' action="">
	            {% csrf_token %}
	            
	            {{form.management_form}}
	            {{form.as_p}}
	            <div>
	            		{{catagory_form.management_form}}
	            		{{catagory_form.as_p}}
	            		
	                <input type="submit" value="ADD CATAGORY" name = '_addcatagory' >
	            </div>

    <input type="submit" value="Add Step" name = '_addstep' >
 	<input type="submit" value="Add Image" name = '_addimage' >
    <input type="submit" value="Save Project" name = '_save' >
    <input type="submit" value="Publish Project" name = '_publish' > 
    <input type="submit" value="Delete Project" name = '_delete_project' >        
<fieldset>
	{% if projectimage %}
		{% for image in projectimage %}
			<ul>
				<img src="{{image.image.url}}" alt="" height = 300 />
			</ul>
		{% endfor %}
	{% endif %}
</fieldset>

<fieldset>
{% if catagories %}
	{% for cat in catagories %}
		<ul>
			{{ cat.catagory }} <input type="submit" value="REMOVE CATAGORY: {{ cat.catagory }}" name = '_remove_catagory_{{ cat.id }}' >
		</ul>	
	{% endfor %}
{% endif %}
</fieldset>

         

{% if projectstep %}
	<h1> Project Steps </h1>
	{% for step in projectstep %}
		<fieldset>
			<h2> Step {{ step.order}} </h2>
			<h5><a href="editstep/{{step.id}}/" > (edit) </a></h5>
			    <input type="submit" value="Move Step Up" name = '_move_{{step.id}}_step_up' > 
			    <input type="submit" value="Move Step Down" name = '_move_{{step.id}}_step_down' > 
			    <input type="submit" value="Delete This Step" name = '_deletestep_{{step.id}}' >
			<ul>
			{{ step.step.project_step_description }}
			{% if step.step.project_step_image %}
				<img src="{{step.step.project_step_image.url}}" alt="" height = 300 />
			{% endif %}
			{% for component in purchasedcomponent %}
				{% if component.purchased_component_for_step == step.step %}
						YES
			</ul>
				<ul>
					<h2>Component: 
						<a href="{{component.product.url}}">{{component.product.name}} 
						</a>
						x {{component.purchased_component_quantity}} -- ${{component.product.price|div:100}}
					</h2>
				</ul>	
				{% endif %}			
			{% endfor %}
			
			{% for component in fabricatedcomponent %}
				{% if component.fabricated_component_for_step == step.step %}
			</ul>
				<ul>
					<h2>Fabricated Component: 
						<a href="/project/{{component.fabricated_component_from_project.project_id}}">
							<img src="{{fabricated_component_thumbnails.image.url}}" alt="" height = 50 />
							{{component.fabricated_component_from_project.project_name}}
					</a>
					x {{component.fabricated_component_quantity}}
				</h2>
				</ul>	
				{% endif %}			
			{% endfor %}

			{% for file in projectfile %}
				{% if file.project_file_for_step == step.step %}
			</ul>
				<ul>
					<h2>File: 
							<a href="{{ file.project_file.url }}" download > {{file.project_file|filename}} </h2></a>
					</a>
				</h2>
				</ul>	
				{% endif %}			
			{% endfor %}						

		</fieldset>

	{% endfor %}

{% endif %}

	            </fieldset>	            
	        </form>
	    </div>
	</body>

{% endblock %}




<!-- 
<body>
	<form enctype="multipart/form-data" method='POST' action="">
		{% csrf_token %}
		<ul>
			<div>
				{% for field in project_form %}
					{{ field }}
				{% endfor %}
			</div>
			<div>
				{{ purchasedcomponent_form.as_ul}}
			</div>
			
			
		</ul
>		<input type="submit" value="Create Project" >
	</form>
</body>
 -->